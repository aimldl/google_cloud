# create_a_notebook_instance
#
#   Prerequisite: run init4hub_vm before running this

# Function definition
run() {
  COMMAND=$1
  echo "$COMMAND"
  eval $COMMAND
}

export REGION=${1:-us-central1}
echo "REGION=$REGION"
echo "Setting the associated variables automatically..."

export INSTANCE_NAME=hub-${REGION}
export PROJECT_ID=$(gcloud config list --format 'value(core.project)')
export ZONE=$REGION-c
export SUBNET=custom-subnetwork-${REGION}
export MACHINE_TYPE=e2-medium                # n1-standard-4
export IMAGE_FAMILY=ubuntu-minimal-2204-lts  # common-cpu-notebooks
export IMAGE_PROJECT=ubuntu-os-cloud         # deeplearning-platform-release

export TIMEOUT_SECONDS=300  # Timeout after 5 minutes
export SLEEP_INTERVAL=30    # seconds

# 1. Create a Notebook instance using the created network and subnet
run "gcloud notebooks instances create $INSTANCE_NAME \
     --location=$LOCATION \
     --subnet-region=$REGION \
     --subnet=$SUBNET \
     --machine-type=$MACHINE_TYPE \
     --vm-image-family=$IMAGE_FAMILY \
     --vm-image-project=$IMAGE_PROJECT"
